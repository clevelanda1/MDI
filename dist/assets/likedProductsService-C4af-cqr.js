import{c as n,z as s}from"./index-8wLK5tP2.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=n("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=n("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);class p{static async ensureAuthenticated(){try{const{data:{session:r},error:e}=await s.auth.getSession();if(e)throw console.error("Auth session error:",e),new Error("Authentication error. Please sign in again.");if(!(r!=null&&r.user))throw new Error("User not authenticated. Please sign in.");return r}catch(r){throw console.error("Error checking authentication:",r),new Error("Authentication check failed. Please sign in again.")}}static async likeProduct(r,e){try{const t=await this.ensureAuthenticated();if(!e.id||e.id.trim()==="")throw console.error("Cannot like product with empty ID:",e),new Error("Product ID is missing or invalid");const o={user_id:t.user.id,project_id:r,asin:e.id,title:e.title,price:e.price,currency:e.currency,rating:e.rating,reviews_count:e.reviews_count,image:e.image,url:e.url,source:e.source},{data:c,error:i}=await s.from("liked_products").insert(o).select().single();if(i)throw console.error("Error liking product:",i),new Error(`Failed to like product: ${i.message}`);return c}catch(t){throw console.error("Error in likeProduct:",t),new Error(t.message||"Failed to like product")}}static async unlikeProduct(r,e){try{const t=await this.ensureAuthenticated(),{error:o}=await s.from("liked_products").delete().eq("user_id",t.user.id).eq("project_id",r).eq("asin",e);if(o)throw console.error("Error unliking product:",o),new Error(`Failed to unlike product: ${o.message}`)}catch(t){throw console.error("Error in unlikeProduct:",t),new Error(t.message||"Failed to unlike product")}}static async isProductLiked(r,e){try{const t=await this.ensureAuthenticated(),{data:o,error:c}=await s.from("liked_products").select("id").eq("user_id",t.user.id).eq("project_id",r).eq("asin",e).single();return c&&c.code!=="PGRST116"?(console.error("Error checking if product is liked:",c),!1):!!o}catch(t){return console.error("Error in isProductLiked:",t),!1}}static async getLikedProducts(){try{const r=await this.ensureAuthenticated(),{data:e,error:t}=await s.from("liked_products").select("*").eq("user_id",r.user.id).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching liked products:",t),new Error(`Failed to fetch liked products: ${t.message}`);return e||[]}catch(r){throw console.error("Error in getLikedProducts:",r),new Error(r.message||"Failed to fetch liked products")}}static async getLikedProductsForProject(r){try{const e=await this.ensureAuthenticated(),{data:t,error:o}=await s.from("liked_products").select("*").eq("user_id",e.user.id).eq("project_id",r).order("created_at",{ascending:!1});if(o)throw console.error("Error fetching liked products for project:",o),new Error(`Failed to fetch liked products: ${o.message}`);return t||[]}catch(e){throw console.error("Error in getLikedProductsForProject:",e),new Error(e.message||"Failed to fetch liked products for project")}}static async getLikedProductsWithProjects(){try{const r=await this.ensureAuthenticated(),{data:e,error:t}=await s.from("liked_products").select(`
          *,
          project:projects(*)
        `).eq("user_id",r.user.id).order("created_at",{ascending:!1});if(t)throw console.error("Error fetching liked products with projects:",t),new Error(`Failed to fetch liked products: ${t.message}`);return e||[]}catch(r){throw console.error("Error in getLikedProductsWithProjects:",r),new Error(r.message||"Failed to fetch liked products with projects")}}static async getProjectsWithLikedProducts(){try{const r=await this.ensureAuthenticated(),{data:e,error:t}=await s.from("liked_products").select(`
          project:projects(*)
        `).eq("user_id",r.user.id);if(t)throw console.error("Error fetching projects with liked products:",t),new Error(`Failed to fetch projects: ${t.message}`);return((e==null?void 0:e.map(i=>i.project).filter(Boolean))||[]).filter((i,a,d)=>a===d.findIndex(u=>u.id===i.id))}catch(r){throw console.error("Error in getProjectsWithLikedProducts:",r),new Error(r.message||"Failed to fetch projects with liked products")}}static likedProductToUnifiedProduct(r){return{title:r.title,price:r.price||0,currency:r.currency||"USD",rating:r.rating||0,reviews_count:r.reviews_count||0,image:r.image||"",url:r.url||"",id:r.asin,asin:r.asin,source:r.source||"amazon",originalData:{title:r.title,price:r.price||0,currency:r.currency||"USD",rating:r.rating||0,reviewsCount:r.reviews_count||0,image:r.image||"",url:r.url||"",asin:r.asin}}}}export{w as F,g as H,p as L};
