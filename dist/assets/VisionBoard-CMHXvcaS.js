import{c as Z,h as v,z as I,C as de,q as e,t as o,A as R,X as ee,E as X,D as oe}from"./index-8wLK5tP2.js";import{L as te,H as ce,F as xe}from"./likedProductsService-C4af-cqr.js";import{A as J}from"./alert-circle-mFFPV712.js";import{F as ae}from"./folder-open-e8JQSl-n.js";import{E as ie}from"./eye-MYrhNOcT.js";import{T as pe,P as ge}from"./trash-2-V8kPF9HU.js";import{V as ne}from"./visionBoardShareService-B0R-BPAy.js";import{S as se,E as be}from"./share-2-Cprh77f_.js";import{C as ve}from"./calendar-CVpwYZaz.js";import{C as le}from"./check-iN1kQgfS.js";import{E as fe}from"./eye-off-CCGDSEKR.js";import{S as ye}from"./sparkles-CR9GoJ4R.js";import{S as we}from"./search-h4tSjVuG.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=Z("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=Z("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=Z("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=Z("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Se=()=>{const[i,t]=v.useState({likedProducts:[],projects:[],isLoading:!0});v.useEffect(()=>{r()},[]);const r=async()=>{try{t(m=>({...m,isLoading:!0}));const a=await te.getLikedProductsWithProjects(),n=a.map(m=>m.project).filter((m,l,h)=>m&&l===h.findIndex(c=>c.id===m.id));t({likedProducts:a,projects:n,isLoading:!1}),console.log(`Loaded ${a.length} liked products from ${n.length} projects`)}catch(a){console.error("Error loading vision board data:",a),t(n=>({...n,isLoading:!1}))}};return{...i,refreshData:()=>{r()}}};class W{static async ensureAuthenticated(){try{const{data:{session:t},error:r}=await I.auth.getSession();if(r)throw console.error("Auth session error:",r),new Error("Authentication error. Please sign in again.");if(!(t!=null&&t.user))throw new Error("User not authenticated. Please sign in.");return t}catch(t){throw console.error("Error checking authentication:",t),new Error("Authentication check failed. Please sign in again.")}}static async saveVisionBoard(t,r,s,a){try{const n=await this.ensureAuthenticated(),m={items:r,totalBudget:s,createdAt:new Date().toISOString()},{data:l,error:h}=await I.from("vision_boards").select("*").eq("user_id",n.user.id).eq("name",t).eq("is_saved",!0).maybeSingle();if(h&&h.code!=="PGRST116")throw console.error("Error checking for existing board:",h),new Error(`Failed to check for existing board: ${h.message}`);let c;if(l){console.log("Updating existing board:",l.id);const{error:d}=await I.from("vision_board_items").delete().eq("vision_board_id",l.id);if(d)throw console.error("Error deleting existing vision board items:",d),new Error(`Failed to update vision board items: ${d.message}`);r.length>0&&await this.saveVisionBoardItems(l.id,r);const f={board_data:m,updated_at:new Date().toISOString()};a&&(f.preview_image_url=a);const{data:g,error:b}=await I.from("vision_boards").update(f).eq("id",l.id).select().single();if(b)throw console.error("Error updating vision board:",b),new Error(`Failed to update vision board: ${b.message}`);c=g}else{console.log("Creating new vision board");const d={user_id:n.user.id,name:t,description:`Vision board with ${r.length} items`,board_data:m,preview_image_url:a,is_saved:!0},{data:f,error:g}=await I.from("vision_boards").insert(d).select().single();if(g)throw console.error("Error saving vision board:",g),new Error(`Failed to save vision board: ${g.message}`);c=f,r.length>0&&await this.saveVisionBoardItems(c.id,r)}return{...c,board_data:m}}catch(n){throw console.error("Error in saveVisionBoard:",n),new Error(n.message||"Failed to save vision board")}}static async updateVisionBoardName(t,r){try{const s=await this.ensureAuthenticated(),{data:a,error:n}=await I.from("vision_boards").update({name:r,updated_at:new Date().toISOString()}).eq("id",t).eq("user_id",s.user.id).select().single();if(n)throw console.error("Error updating vision board name:",n),new Error(`Failed to update vision board name: ${n.message}`);return a}catch(s){throw console.error("Error in updateVisionBoardName:",s),new Error(s.message||"Failed to update vision board name")}}static async saveVisionBoardItems(t,r){try{console.log(`Saving ${r.length} items for vision board ${t}`);const s=[];for(const a of r){const{data:n,error:m}=await I.from("liked_products").select("id").eq("asin",a.asin).eq("user_id",(await this.ensureAuthenticated()).user.id).maybeSingle();if(m){console.error("Error finding liked product:",m);continue}if(n)s.push({vision_board_id:t,liked_product_id:n.id,x:a.x,y:a.y,width:a.width,height:a.height,rotation:a.rotation,z_index:1});else{console.warn(`Liked product not found for asin ${a.asin}, creating it now`);try{const l=te.likedProductToUnifiedProduct(a),h=await te.likeProduct(a.project_id,l);s.push({vision_board_id:t,liked_product_id:h.id,x:a.x,y:a.y,width:a.width,height:a.height,rotation:a.rotation,z_index:1})}catch(l){console.error("Error creating liked product:",l);continue}}}if(s.length>0){const{error:a}=await I.from("vision_board_items").insert(s);if(a)throw console.error("Error inserting vision board items:",a),new Error(`Failed to save vision board items: ${a.message}`);console.log(`Successfully saved ${s.length} vision board items`)}}catch(s){throw console.error("Error in saveVisionBoardItems:",s),new Error(s.message||"Failed to save vision board items")}}static async getSavedVisionBoards(){try{console.log("üîç getSavedVisionBoards: Starting to fetch saved vision boards");const t=await this.ensureAuthenticated();console.log("üîë getSavedVisionBoards: User authenticated:",t.user.id);const{data:r,error:s}=await I.from("vision_boards").select("*").eq("user_id",t.user.id).eq("is_saved",!0).order("updated_at",{ascending:!1});if(s)throw console.error("‚ùå getSavedVisionBoards: Error fetching saved vision boards:",s),new Error(`Failed to fetch saved vision boards: ${s.message}`);return console.log(`üìã getSavedVisionBoards: Found ${(r==null?void 0:r.length)||0} saved boards`),(r||[]).map(a=>(a.board_data?typeof a.board_data!="object"&&(a.board_data={items:[],totalBudget:0,createdAt:a.created_at}):a.board_data={items:[],totalBudget:0,createdAt:a.created_at},a.board_data.items||(a.board_data.items=[]),(a.board_data.totalBudget===void 0||a.board_data.totalBudget===null)&&(console.log(`üìä Calculating missing totalBudget for board ${a.id}`),a.board_data.totalBudget=a.board_data.items.reduce((n,m)=>{const l=m.price||0;return n+l},0)),a.board_data.createdAt||(a.board_data.createdAt=a.created_at),{...a,board_data:a.board_data}))}catch(t){throw console.error("‚ùå getSavedVisionBoards: Error in getSavedVisionBoards:",t),new Error(t.message||"Failed to fetch saved vision boards")}}static async getVisionBoard(t){try{return await this.getVisionBoardWithItems(t)}catch(r){throw console.error("Error in getVisionBoard:",r),r.message.includes("not authenticated")?r:new Error(r.message||"Failed to fetch vision board")}}static async getVisionBoardWithItems(t){try{console.log(`üîç getVisionBoardWithItems: Starting to fetch board ${t} with items`);const r=await this.ensureAuthenticated();console.log(`üîë getVisionBoardWithItems: User authenticated for board ${t}`);const{data:s,error:a}=await I.from("vision_boards").select("*").eq("id",t).eq("user_id",r.user.id).eq("is_saved",!0).single();if(a){if(a.code==="PGRST116")return console.log(`‚ùì getVisionBoardWithItems: Board ${t} not found`),null;throw console.error(`‚ùå getVisionBoardWithItems: Error fetching board ${t}:`,a),new Error(`Failed to fetch vision board: ${a.message}`)}console.log(`üìã getVisionBoardWithItems: Board ${t} metadata:`,s),console.log(`üîç getVisionBoardWithItems: Fetching items for board ${t}`);const{data:n,error:m}=await I.from("vision_board_items").select(`
          *,
          liked_product:liked_products(*)
        `).eq("vision_board_id",t).order("z_index",{ascending:!0});if(m)throw console.error(`‚ùå getVisionBoardWithItems: Error fetching items for board ${t}:`,m),new Error(`Failed to fetch vision board items: ${m.message}`);console.log(`üìã getVisionBoardWithItems: Found ${n.length} items for board ${t}`);const l=n.map(c=>{const d=c.liked_product;return{boardId:c.id,x:c.x,y:c.y,width:c.width,height:c.height,rotation:c.rotation,id:d.id,user_id:d.user_id,project_id:d.project_id,asin:d.asin,title:d.title,price:d.price,currency:d.currency,rating:d.rating,reviews_count:d.reviews_count,image:d.image,url:d.url,created_at:d.created_at,source:d.source}});console.log(`‚úÖ getVisionBoardWithItems: Transformed ${l.length} items for board ${t}`);const h=l.reduce((c,d)=>c+(d.price||0),0);return s.board_data||(s.board_data={}),{...s,board_data:{items:l,totalBudget:h,createdAt:s.board_data.createdAt||s.created_at}}}catch(r){throw console.error(`‚ùå getVisionBoardWithItems: Error getting board ${t} with items:`,r),new Error(r.message||"Failed to fetch vision board with items")}}static async updateVisionBoard(t,r,s,a,n){try{const m=await this.ensureAuthenticated(),{error:l}=await I.from("vision_board_items").delete().eq("vision_board_id",t);if(l)throw console.error("Error deleting existing vision board items:",l),new Error(`Failed to update vision board items: ${l.message}`);s.length>0&&await this.saveVisionBoardItems(t,s);const h={items:s,totalBudget:a,createdAt:new Date().toISOString()},c={name:r,board_data:h,updated_at:new Date().toISOString()};n&&(c.preview_image_url=n);const{data:d,error:f}=await I.from("vision_boards").update(c).eq("id",t).eq("user_id",m.user.id).select().single();if(f)throw console.error("Error updating vision board:",f),new Error(`Failed to update vision board: ${f.message}`);if(!d)throw new Error("No data returned from vision board update");return{...d,board_data:h}}catch(m){throw console.error("Error in updateVisionBoard:",m),new Error(m.message||"Failed to update vision board")}}static async deleteVisionBoard(t){try{const r=await this.ensureAuthenticated(),{error:s}=await I.from("vision_boards").delete().eq("id",t).eq("user_id",r.user.id);if(s)throw console.error("Error deleting vision board:",s),new Error(`Failed to delete vision board: ${s.message}`)}catch(r){throw console.error("Error in deleteVisionBoard:",r),new Error(r.message||"Failed to delete vision board")}}static async generatePreviewImage(t){try{return null}catch(r){return console.error("Error generating preview image:",r),null}}}const ke=()=>{const{subscription:i,limits:t}=de(),[r,s]=v.useState({boardItems:[],selectedItem:null,showSidebar:!0}),[a,n]=v.useState([]),[m,l]=v.useState(!1),[h,c]=v.useState(!1),[d,f]=v.useState(void 0),[g,b]=v.useState("My Vision Board"),[w,j]=v.useState(null),x=!0,S=i.tier!=="free",y=i.tier==="free"&&a.length>=t.visionBoards&&!d||i.tier==="pro"&&a.length>=t.visionBoards&&!d;v.useEffect(()=>{T()},[]);const B=v.useMemo(()=>r.boardItems.reduce((p,u)=>p+(u.price||0),0),[r.boardItems]),D=(p,u,k,E)=>{let _=u??300,$=k??300;E&&(_=Math.max(10,Math.min(_,E.width-210)),$=Math.max(10,Math.min($,E.height-210)));const K=crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,H={...p,boardId:K,x:_,y:$,width:200,height:200,rotation:0};return s(Y=>({...Y,boardItems:[...Y.boardItems,H]})),f(void 0),H},V=(p,u,k)=>{s(E=>({...E,boardItems:E.boardItems.map(_=>_.boardId===p?{..._,x:u,y:k}:_)})),f(void 0)},z=(p,u,k)=>{s(E=>({...E,boardItems:E.boardItems.map(_=>_.boardId===p?{..._,width:u,height:k}:_)})),f(void 0)},F=p=>{s(u=>({...u,boardItems:u.boardItems.filter(k=>k.boardId!==p),selectedItem:u.selectedItem===p?null:u.selectedItem})),f(void 0)},A=p=>{s(u=>({...u,selectedItem:p===u.selectedItem?null:p}))},N=()=>{s(p=>({...p,boardItems:[],selectedItem:null})),f(void 0),b("My Vision Board")},Q=()=>{s(p=>({...p,showSidebar:!p.showSidebar}))},U=async p=>{try{if(y&&!d)throw new Error(`You've reached the limit of ${t.visionBoards} saved board${t.visionBoards!==1?"s":""} for your subscription tier. Please upgrade or delete some boards.`);j(null),c(!0),b(p);const u=await W.generatePreviewImage(r.boardItems),k=await W.saveVisionBoard(p,r.boardItems,B,u||void 0);return n(E=>{const _=E.filter($=>$.id!==k.id);return[k,..._]}),f(k.id),console.log("Board saved successfully:",k.name),k}catch(u){throw console.error("Error saving board:",u),j(u.message||"Failed to save vision board"),new Error(u.message||"Failed to save vision board")}finally{c(!1)}},G=async(p,u)=>{try{if(!p)throw new Error("No board ID provided");c(!0),await W.updateVisionBoardName(p,u),b(u),n(k=>k.map(E=>E.id===p?{...E,name:u}:E)),console.log("Board name updated successfully:",u)}catch(k){throw console.error("Error updating board name:",k),new Error(k.message||"Failed to update board name")}finally{c(!1)}},M=async p=>{try{const u=await W.getVisionBoard(p);if(!u||!u.board_data)throw new Error("Vision board not found or has no data");const k=u.board_data.items||[];s(E=>({...E,boardItems:k,selectedItem:null})),f(p),b(u.name),console.log("Board loaded successfully:",u.name)}catch(u){throw console.error("Error loading board:",u),new Error(u.message||"Failed to load vision board")}},q=async p=>{try{await W.deleteVisionBoard(p),n(u=>u.filter(k=>k.id!==p)),d===p&&(f(void 0),b("My Vision Board"),s(u=>({...u,boardItems:[],selectedItem:null}))),console.log("Board deleted successfully")}catch(u){throw console.error("Error deleting board:",u),new Error(u.message||"Failed to delete vision board")}},T=async()=>{try{console.log("üîç Starting to load saved vision boards..."),l(!0);const p=await W.getSavedVisionBoards();console.log("‚úÖ Loaded saved vision boards:",p.length,p),n(p)}catch(p){throw console.error("‚ùå Error loading saved boards:",p),new Error(p.message||"Failed to load saved boards")}finally{l(!1)}};return{...r,totalBudget:B,savedBoards:a,isLoadingSavedBoards:m,isSaving:h,currentBoardId:d,currentBoardName:g,saveError:w,canSaveVisionBoards:x,canShareVisionBoards:S,hasReachedSavedBoardsLimit:y,addItemToBoard:D,moveItem:V,resizeItem:z,removeItem:F,selectItem:A,clearBoard:N,toggleSidebar:Q,saveBoard:U,updateBoardName:G,loadBoard:M,deleteBoard:q,loadSavedBoards:T}},Ee=(i,t)=>{const[r,s]=v.useState({draggedItem:null,isDragOver:!1,dragCounter:0}),a=v.useRef(0),n=(g,b)=>{console.log("Starting drag for product:",b.title),s(j=>({...j,draggedItem:b})),g.dataTransfer.effectAllowed="copy";const w=g.currentTarget.cloneNode(!0);w.style.transform="rotate(5deg) scale(1.1)",w.style.opacity="0.8",g.dataTransfer.setDragImage(w,50,50)},m=v.useCallback(g=>{if(g.preventDefault(),a.current=0,s(b=>({...b,isDragOver:!1,dragCounter:0})),r.draggedItem&&t.current){const b=t.current.getBoundingClientRect(),w=g.clientX-b.left-100,j=g.clientY-b.top-100;console.log("Dropping product at:",w,j),i(r.draggedItem,w,j,{width:b.width,height:b.height}),s(x=>({...x,draggedItem:null})),d(g.clientX,g.clientY)}},[r.draggedItem,i,t]),l=g=>{g.preventDefault(),g.dataTransfer.dropEffect="copy"},h=g=>{g.preventDefault(),a.current++,s(b=>({...b,isDragOver:!0,dragCounter:a.current}))},c=g=>{g.preventDefault(),a.current--,a.current===0&&s(b=>({...b,isDragOver:!1,dragCounter:0}))},d=(g,b)=>{const w=document.createElement("div");w.className="fixed pointer-events-none z-50 text-emerald-600 font-semibold text-sm bg-white/90 backdrop-blur-sm border border-emerald-200 rounded-full px-3 py-1 shadow-lg",w.textContent="Added to board!",w.style.left=`${g}px`,w.style.top=`${b}px`,w.style.transform="translate(-50%, -50%)",document.body.appendChild(w),setTimeout(()=>{w.style.opacity="0",w.style.transform="translate(-50%, -50%) scale(0.8)",w.style.transition="all 0.3s ease-out",setTimeout(()=>{document.body.removeChild(w)},300)},1e3)};return{...r,handleDragStart:n,handleDrop:m,handleDragOver:l,handleDragEnter:h,handleDragLeave:c,handleDoubleClick:g=>{console.log("Double-clicking product:",g.title);const w=(()=>{if(!t.current)return{x:300,y:300};const j=t.current.getBoundingClientRect();return{x:j.width/2-100,y:j.height/2-100}})();i(g,w.x,w.y,t.current?{width:t.current.getBoundingClientRect().width,height:t.current.getBoundingClientRect().height}:void 0),d(w.x+100,w.y+100)},showAddFeedback:d}},Be=(i,t)=>{const[r,s]=v.useState({searchQuery:"",selectedProject:"all"}),a=v.useMemo(()=>i.filter(c=>{const d=c.title.toLowerCase().includes(r.searchQuery.toLowerCase()),f=r.selectedProject==="all"||c.project&&c.project.id===r.selectedProject;return d&&f}),[i,r]),n=v.useMemo(()=>[{id:"all",name:"All Projects"},...t.map(c=>({id:c.id,name:c.name}))],[t]);return{filters:r,filteredProducts:a,projectOptions:n,updateSearchQuery:c=>{s(d=>({...d,searchQuery:c}))},updateSelectedProject:c=>{s(d=>({...d,selectedProject:c}))},clearFilters:()=>{s({searchQuery:"",selectedProject:"all"})}}},_e=()=>e.jsxs(o.div,{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-indigo-900 text-white py-16 lg:py-20 relative overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsxs("svg",{className:"w-full h-full",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"hero-dots",width:"60",height:"60",patternUnits:"userSpaceOnUse",children:e.jsx("circle",{cx:"30",cy:"30",r:"2",fill:"currentColor"})})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#hero-dots)",className:"text-white"})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 relative z-10",children:e.jsxs(o.div,{className:"max-w-4xl",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[e.jsx(o.div,{className:"flex mb-8",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.3},children:e.jsxs("a",{href:"/studio",className:"inline-flex items-center text-slate-300 hover:text-white transition-all duration-300 font-medium group bg-white/10 backdrop-blur-sm px-5 py-3 rounded-full hover:bg-white/20",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"text-sm",children:"Back to Studio"})]})}),e.jsx("div",{className:"w-16 h-1 bg-gradient-to-r from-violet-400 to-blue-400 mb-6 rounded-full"}),e.jsxs("h1",{className:"font-light text-4xl md:text-5xl lg:text-6xl mb-6 leading-tight",children:["Vision Board",e.jsx("span",{className:"block font-semibold bg-gradient-to-r from-white to-slate-300 bg-clip-text text-transparent",children:"Studio"})]}),e.jsx("p",{className:"text-xl text-slate-300 leading-relaxed max-w-3xl font-light",children:"Create stunning visual mood boards by arranging your favorite products. Drag items from the sidebar or double-click to add them to the center of your board."})]})})]}),Ce=({isOpen:i,onClose:t,onSave:r,isLoading:s=!1,initialName:a="",error:n=null,hasReachedLimit:m=!1,maxBoards:l=1})=>{const[h,c]=v.useState(""),[d,f]=v.useState("");v.useEffect(()=>{i&&(c(a||""),f(""))},[i,a]),v.useEffect(()=>{n&&f(n)},[n]);const g=j=>{j.target===j.currentTarget&&t()},b=async()=>{if(!h.trim()){f("Please enter a board name");return}if(m){f(`You've reached the limit of ${l} saved board${l!==1?"s":""}. Please upgrade your plan or delete some boards.`);return}try{f(""),await r(h.trim()),c(""),t()}catch(j){f(j.message||"Failed to save vision board")}},w=j=>{j.key==="Enter"&&!s?b():j.key==="Escape"&&t()};return e.jsx(R,{children:i&&e.jsxs(o.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsx(o.div,{className:"absolute inset-0 bg-slate-900/50 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:g}),e.jsxs(o.div,{className:"relative w-full max-w-md bg-white/95 backdrop-blur-xl border border-slate-200/60 rounded-3xl shadow-2xl shadow-slate-900/20 overflow-hidden",initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,ease:[.22,1,.36,1]},children:[e.jsx(o.button,{onClick:t,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100/60 rounded-full transition-all duration-200 z-10",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(ee,{size:18})}),e.jsxs("div",{className:"p-8",children:[e.jsx(o.div,{className:"w-16 h-16 bg-gradient-to-br from-violet-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-6",initial:{scale:0},animate:{scale:1},transition:{delay:.1,duration:.3,ease:"easeOut"},children:e.jsx(re,{size:24,className:"text-white"})}),e.jsx(o.h2,{className:"text-2xl font-semibold text-slate-900 text-center mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.3},children:"Save Vision Board"}),e.jsx(o.p,{className:"text-slate-600 text-center leading-relaxed mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:"Give your vision board a name to save it for later"}),m&&e.jsx(o.div,{className:"mb-6 p-4 bg-amber-50/80 border border-amber-200 rounded-2xl",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(J,{size:18,className:"text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 text-sm font-medium mb-1",children:"Board Limit Reached"}),e.jsxs("p",{className:"text-amber-700 text-xs leading-relaxed",children:["You've reached the limit of ",l," saved board",l!==1?"s":""," for your current plan. Please upgrade your subscription or delete some boards to continue."]}),e.jsx("a",{href:"/upgrade",className:"text-xs text-amber-800 font-medium mt-1 inline-block hover:underline",children:"View Upgrade Options"})]})]})}),e.jsxs(o.div,{className:"mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Board Name"}),e.jsx("input",{type:"text",value:h,onChange:j=>c(j.target.value),onKeyDown:w,placeholder:"Enter board name...",className:"w-full px-4 py-3 border border-slate-300/60 rounded-2xl focus:outline-none focus:ring-2 focus:ring-violet-500/50 focus:border-violet-500 bg-white/60 backdrop-blur-sm transition-all duration-300",disabled:s||m,autoFocus:!0}),d&&e.jsx(o.p,{className:"mt-2 text-sm text-red-600",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:d})]}),e.jsxs(o.div,{className:"flex flex-col sm:flex-row gap-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.3},children:[e.jsx(o.button,{onClick:t,disabled:s,className:"flex-1 px-6 py-3 border border-slate-300/60 rounded-2xl font-medium text-slate-700 hover:bg-slate-50/80 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Cancel"}),e.jsx(o.button,{onClick:b,disabled:!h.trim()||s||m,className:"flex-1 px-6 py-3 rounded-2xl font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 bg-violet-600 hover:bg-violet-700 text-white",whileHover:{scale:1.02},whileTap:{scale:.98},children:s?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"animate-spin",size:16}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{size:16}),e.jsx("span",{children:"Save Board"})]})})]})]})]})]})})},De=({isOpen:i,onClose:t,onLoad:r,onDelete:s,savedBoards:a,isLoading:n=!1,onLoadSavedBoards:m})=>{const[l,h]=v.useState(null),[c,d]=v.useState(null);v.useEffect(()=>{i&&a.length===0&&m().catch(x=>{console.error("‚ùå LoadVisionBoardModal: Error loading saved boards:",x)})},[i,m,a.length]);const f=x=>{x.target===x.currentTarget&&t()},g=async x=>{try{h(x),await r(x),t()}catch(S){console.error("‚ùå LoadVisionBoardModal: Error loading board:",S)}finally{h(null)}},b=async(x,S)=>{S.stopPropagation();try{d(x),await s(x)}catch(y){console.error("‚ùå LoadVisionBoardModal: Error deleting board:",y)}finally{d(null)}},w=x=>{try{return new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(S){return console.error("‚ùå Error formatting date:",x,S),"Invalid Date"}},j=n&&a.length===0;return e.jsx(R,{children:i&&e.jsxs(o.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsx(o.div,{className:"absolute inset-0 bg-slate-900/50 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:f}),e.jsxs(o.div,{className:"relative w-full max-w-4xl bg-white/95 backdrop-blur-xl border border-slate-200/60 rounded-3xl shadow-2xl shadow-slate-900/20 overflow-hidden",initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,ease:[.22,1,.36,1]},children:[e.jsx(o.button,{onClick:t,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100/60 rounded-full transition-all duration-200 z-10",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(ee,{size:18})}),e.jsxs("div",{className:"p-8",children:[e.jsx(o.div,{className:"w-16 h-16 bg-gradient-to-br from-violet-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-6",initial:{scale:0},animate:{scale:1},transition:{delay:.1,duration:.3,ease:"easeOut"},children:e.jsx(ae,{size:24,className:"text-white"})}),e.jsx(o.h2,{className:"text-2xl font-semibold text-slate-900 text-center mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.3},children:"Load Vision Board"}),e.jsx(o.p,{className:"text-slate-600 text-center leading-relaxed mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:"Choose a saved vision board to continue working"}),e.jsx(o.div,{className:"mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},children:e.jsx("div",{className:"h-96 overflow-y-auto rounded-2xl border border-slate-200/60 bg-slate-50/30 p-4",children:e.jsx(R,{mode:"wait",children:j?e.jsxs(o.div,{className:"flex flex-col items-center justify-center py-12",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3},children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-violet-100 to-blue-100 rounded-2xl flex items-center justify-center mb-4",children:e.jsx(X,{className:"animate-spin text-violet-600",size:24})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Loading your boards..."}),e.jsx("p",{className:"text-slate-600 text-sm",children:"This will just take a moment"})]},"loading-state"):a.length===0?e.jsxs(o.div,{className:"flex flex-col items-center justify-center py-12",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-slate-100 to-slate-200 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(ae,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No saved boards yet"}),e.jsx("p",{className:"text-slate-600 text-center text-sm leading-relaxed",children:"Create your first vision board and save it to see it here"})]},"empty-state"):e.jsx(o.div,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:a.map((x,S)=>{var y,B,D,V;return e.jsxs(o.div,{className:"group relative bg-white/80 backdrop-blur-sm border border-slate-200/60 rounded-2xl p-4 shadow-sm hover:shadow-md transition-all duration-300 cursor-pointer",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:S*.05,duration:.3},onClick:()=>g(x.id),whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-slate-900 text-sm mb-1 truncate group-hover:text-violet-700 transition-colors",children:x.name||`Vision Board ${S+1}`}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-1",children:x.description||"Custom vision board"})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 ml-2",children:[e.jsx(o.button,{onClick:z=>{z.stopPropagation(),g(x.id)},className:"p-1.5 bg-violet-100 hover:bg-violet-200 text-violet-600 rounded-lg transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(ie,{size:12})}),e.jsx(o.button,{onClick:z=>b(x.id,z),disabled:c===x.id,className:"p-1.5 bg-red-100 hover:bg-red-200 text-red-600 rounded-lg transition-colors disabled:opacity-50",whileHover:{scale:1.1},whileTap:{scale:.9},children:c===x.id?e.jsx(X,{className:"animate-spin",size:12}):e.jsx(pe,{size:12})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsx("div",{className:"text-center p-3 bg-slate-50 rounded-lg",children:e.jsx("div",{className:"text-slate-500 text-xs mb-1 font-medium",children:x.created_at?w(x.created_at):"No date"})}),e.jsx("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"text-green-700 text-sm font-semibold",children:["$",((B=(y=x.board_data)==null?void 0:y.totalBudget)==null?void 0:B.toLocaleString())||"0"]})}),e.jsx("div",{className:"text-center p-3 bg-violet-50 rounded-lg",children:e.jsxs("div",{className:"text-violet-700 text-sm font-semibold",children:[((V=(D=x.board_data)==null?void 0:D.items)==null?void 0:V.length)||0," items"]})})]}),l===x.id&&e.jsx(o.div,{className:"absolute inset-0 bg-white/90 backdrop-blur-sm flex items-center justify-center rounded-2xl",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-violet-500 to-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(X,{className:"animate-spin text-white",size:16})}),e.jsx("p",{className:"text-xs font-medium text-slate-700",children:"Loading..."})]})})]},x.id)})},"boards-grid")})})}),e.jsx(o.div,{className:"flex justify-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.3},children:e.jsx(o.button,{onClick:t,className:"px-6 py-3 border border-slate-300/60 rounded-2xl font-medium text-slate-700 hover:bg-slate-50/80 transition-all duration-300",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Close"})}),a.length>0&&!j&&e.jsx(o.div,{className:"mt-6 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:e.jsx("p",{className:"text-xs text-slate-500",children:"Click on any board to load it instantly"})})]})]})]})})},Ve=({isOpen:i,onClose:t,boardName:r,boardItems:s,totalBudget:a,originalBoardId:n,isLoading:m=!1,isSaved:l=!1,canShare:h=!1})=>{const[c,d]=v.useState(""),[f,g]=v.useState(!1),[b,w]=v.useState(!1),[j,x]=v.useState(""),[S,y]=v.useState(null),B=N=>{N.target===N.currentTarget&&t()},D=async()=>{try{if(!h){x("You need to upgrade to Pro or Studio to share vision boards");return}if(!l){x("You must save the vision board before sharing it");return}if(!n){x("Unable to share: No saved board ID found");return}g(!0),x("");const{shareUrl:N}=await ne.createSharedVisionBoard(n,S||void 0);d(N)}catch(N){x(N.message||"Failed to create shareable link")}finally{g(!1)}},V=async()=>{try{await ne.copyToClipboard(c),w(!0),setTimeout(()=>w(!1),2e3)}catch{x("Failed to copy link to clipboard")}},z=()=>{window.open(c,"_blank")},F=()=>{t(),window.location.href="/upgrade"},A=[{label:"Never expires",value:null},{label:"1 day",value:1},{label:"7 days",value:7},{label:"30 days",value:30},{label:"90 days",value:90}];return e.jsx(R,{children:i&&e.jsxs(o.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsx(o.div,{className:"absolute inset-0 bg-slate-900/50 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:B}),e.jsxs(o.div,{className:"relative w-full max-w-lg bg-white/95 backdrop-blur-xl border border-slate-200/60 rounded-3xl shadow-2xl shadow-slate-900/20 overflow-hidden",initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.3,ease:[.22,1,.36,1]},children:[e.jsx(o.button,{onClick:t,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100/60 rounded-full transition-all duration-200 z-10",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(ee,{size:20})}),e.jsxs("div",{className:"p-8",children:[e.jsx(o.div,{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-2xl flex items-center justify-center mx-auto mb-6",initial:{scale:0},animate:{scale:1},transition:{delay:.1,duration:.3,ease:"easeOut"},children:e.jsx(se,{size:24,className:"text-white"})}),e.jsx(o.h2,{className:"text-2xl font-semibold text-slate-900 text-center mb-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.3},children:"Share Vision Board"}),e.jsxs(o.p,{className:"text-slate-600 text-center leading-relaxed mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:['Create a shareable link for "',r,'" with ',s.length," items"]}),!h&&e.jsx(o.div,{className:"mb-6 p-4 bg-amber-50/80 border border-amber-200 rounded-2xl",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(oe,{size:18,className:"text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 text-sm font-medium mb-1",children:"Upgrade Required"}),e.jsx("p",{className:"text-amber-700 text-xs leading-relaxed",children:"Vision board sharing is available on Pro and Studio plans. Upgrade now to share your vision boards with clients and collaborators."}),e.jsx(o.button,{onClick:F,className:"mt-2 px-3 py-1.5 bg-amber-600 text-white text-xs rounded-lg font-medium hover:bg-amber-700 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Upgrade Now"})]})]})}),!l&&e.jsx(o.div,{className:"mb-6 p-4 bg-amber-50/80 border border-amber-200 rounded-2xl",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(J,{size:18,className:"text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 text-sm font-medium mb-1",children:"Board Not Saved"}),e.jsx("p",{className:"text-amber-700 text-xs leading-relaxed",children:'You need to save your vision board before sharing it. Please use the "Save" button in the control bar first.'})]})]})}),c?e.jsxs(e.Fragment,{children:[e.jsxs(o.div,{className:"mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},children:[e.jsxs("div",{className:"bg-emerald-50/80 border border-emerald-200 rounded-2xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-700 mb-2",children:[e.jsx(le,{size:16}),e.jsx("span",{className:"font-medium",children:"Link created successfully!"})]}),e.jsx("p",{className:"text-emerald-600 text-sm",children:"Anyone with this link can view the collection and access product links."})]}),e.jsxs("div",{className:"bg-slate-50/80 border border-slate-200 rounded-2xl p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Shareable Link"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:c,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-slate-300/60 rounded-lg text-sm font-mono text-slate-600"}),e.jsx(o.button,{onClick:V,className:`p-2 rounded-lg transition-all duration-200 ${b?"bg-emerald-100 text-emerald-600":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Copy to clipboard",children:b?e.jsx(le,{size:16}):e.jsx(je,{size:16})}),e.jsx(o.button,{onClick:z,className:"p-2 bg-blue-100 text-blue-600 hover:bg-blue-200 rounded-lg transition-all duration-200",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Open in new tab",children:e.jsx(be,{size:16})})]})]})]}),e.jsx(o.div,{className:"bg-blue-50/80 border border-blue-200 rounded-2xl p-4 mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.3},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ie,{size:16,className:"text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-800 text-sm font-medium mb-1",children:"Public Access"}),e.jsx("p",{className:"text-blue-700 text-xs leading-relaxed",children:"Visitors can view all items on your vision board and click through to purchase on Amazon or Wayfair. No account required to view the board."})]})]})}),e.jsx(o.button,{onClick:t,className:"w-full px-6 py-3 border border-slate-300/60 rounded-2xl font-medium text-slate-700 hover:bg-slate-50/80 transition-all duration-300",whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.3},children:"Done"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o.div,{className:"mb-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.3},children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:[e.jsx(ve,{size:16,className:"inline mr-2"}),"Link Expiration"]}),e.jsx("div",{className:"space-y-2",children:A.map(N=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"expiry",value:N.value||"",checked:S===N.value,onChange:()=>y(N.value),className:"form-radio h-4 w-4 text-blue-600 border-slate-300 focus:ring-blue-500",disabled:!h||!l}),e.jsx("span",{className:"ml-3 text-sm text-slate-700",children:N.label})]},N.label))})]}),j&&e.jsx(o.div,{className:"mb-4 p-3 bg-red-50/80 border border-red-200 rounded-2xl",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:e.jsx("p",{className:"text-red-700 text-sm",children:j})}),e.jsx(o.button,{onClick:D,disabled:f||s.length===0||!h||!l||!n,className:"w-full px-6 py-3 rounded-2xl font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white",whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.3},children:f?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"animate-spin",size:16}),e.jsx("span",{children:"Creating Link..."})]}):h?l?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:16}),e.jsx("span",{children:"Create Shareable Link"})]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{size:16}),e.jsx("span",{children:"Save Board First"})]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:16}),e.jsx("span",{children:"Upgrade to Share"})]})})]})]})]})]})})},ze=({itemCount:i,totalBudget:t,showSidebar:r,savedBoards:s,isLoadingSavedBoards:a,isSaving:n,boardItems:m,currentBoardId:l,currentBoardName:h,onToggleSidebar:c,onClearBoard:d,onSaveBoard:f,onLoadBoard:g,onDeleteBoard:b,onLoadSavedBoards:w,onUpdateBoardName:j})=>{const{subscription:x,limits:S}=de(),[y,B]=v.useState(!1),[D,V]=v.useState(!1),[z,F]=v.useState(!1),[A,N]=v.useState(!1),[Q,U]=v.useState(null),[G,M]=v.useState(!1),[q,T]=v.useState(h),p=x.tier!=="free",u=x.tier==="free"&&s.length>=S.visionBoards&&!l||x.tier==="pro"&&s.length>=S.visionBoards&&!l,k=async C=>{try{if(u&&!l){U(`You've reached the limit of ${S.visionBoards} saved boards for your ${x.tier} plan.`);return}U(null),await f(C),B(!1)}catch(P){U(P.message||"Failed to save vision board")}},E=()=>{if(i===0){N(!0),setTimeout(()=>N(!1),3e3);return}if(u&&!l){N(!0),setTimeout(()=>N(!1),3e3);return}B(!0)},_=()=>{if(s.length===0&&!a){N(!0),setTimeout(()=>N(!1),3e3);return}V(!0)},$=()=>{if(!p){N(!0),setTimeout(()=>N(!1),3e3);return}if(!l){N(!0),setTimeout(()=>N(!1),3e3);return}F(!0)},K=()=>{l&&(T(h),M(!0))},H=async()=>{if(!l||!j||!q.trim()){M(!1);return}try{await j(l,q.trim()),M(!1)}catch(C){console.error("Error updating board name:",C)}},Y=C=>{C.key==="Enter"?H():C.key==="Escape"&&(M(!1),T(h))},O=!a&&s.length===0,L=!!l;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white/90 backdrop-blur-xl border-b border-slate-200/60 relative z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-slate-600 font-medium",children:[i," items on board"]}),e.jsxs("div",{className:"bg-slate-100/60 px-4 py-2 rounded-full",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Total Budget: "}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["$",t.toLocaleString()]})]}),l&&e.jsx("div",{className:"bg-violet-100/60 px-4 py-2 rounded-full flex items-center gap-2",children:G?e.jsx("input",{type:"text",value:q,onChange:C=>T(C.target.value),onBlur:H,onKeyDown:Y,className:"bg-transparent border-b border-violet-300 focus:outline-none focus:border-violet-500 text-sm text-violet-600 font-medium px-1 py-0.5 w-40",autoFocus:!0}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-violet-600 font-medium",children:h}),e.jsx(o.button,{onClick:K,className:"p-1 text-violet-400 hover:text-violet-600 hover:bg-violet-100 rounded-full transition-all duration-200",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(ge,{size:12})})]})}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${x.tier==="studio"?"bg-blue-100 text-blue-700":x.tier==="pro"?"bg-violet-100 text-violet-700":"bg-slate-100 text-slate-700"}`,children:[x.tier.charAt(0).toUpperCase()+x.tier.slice(1)," Plan"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(o.button,{onClick:c,className:"p-2 text-slate-600 hover:text-slate-800 hover:bg-slate-100/60 rounded-full transition-all duration-200",title:"Toggle product sidebar",whileHover:{scale:1.05},whileTap:{scale:.95},children:r?e.jsx(fe,{size:18}):e.jsx(ie,{size:18})}),e.jsx(o.button,{onClick:d,className:"p-2 text-slate-600 hover:text-slate-800 hover:bg-slate-100/60 rounded-full transition-all duration-200",title:"Clear board",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(Ne,{size:18})}),e.jsxs(o.button,{onClick:_,disabled:O,className:`flex items-center space-x-2 px-4 py-2.5 border border-slate-300/60 rounded-full text-slate-600 hover:bg-slate-50/80 transition-all duration-200 font-medium ${O?"opacity-50 cursor-not-allowed hover:bg-transparent":""}`,title:O?"No saved boards to load":"Load saved board",whileHover:{scale:O?1:1.02},whileTap:{scale:O?1:.98},children:[e.jsx(ae,{size:16}),e.jsx("span",{children:"Load"})]}),e.jsxs(o.button,{onClick:E,disabled:i===0||n||u&&!l,className:`flex items-center space-x-2 px-4 py-2.5 border border-slate-300/60 rounded-full text-slate-600 hover:bg-slate-50/80 transition-all duration-200 font-medium ${i===0||n||u&&!l?"opacity-50 cursor-not-allowed hover:bg-transparent":""}`,title:i===0?"Add items to save":u&&!l?`You've reached the limit of ${S.visionBoards} saved boards`:"Save board",whileHover:{scale:i>0&&!n&&!(u&&!l)?1.02:1},whileTap:{scale:i>0&&!n&&!(u&&!l)?.98:1},children:[e.jsx(re,{size:16}),e.jsx("span",{children:n?"Saving...":"Save"})]}),e.jsxs(o.button,{onClick:$,disabled:i===0||!L||!p,className:`flex items-center space-x-2 px-6 py-2.5 bg-slate-900 text-white rounded-full hover:bg-slate-800 transition-all duration-200 font-medium ${i===0||!L||!p?"opacity-50 cursor-not-allowed hover:bg-slate-900":""}`,title:p?L?i===0?"Add items to share":"Share board":"Save board first to share":"Upgrade to Pro or Studio to share boards",whileHover:{scale:p&&L&&i>0?1.02:1},whileTap:{scale:p&&L&&i>0?.98:1},children:[e.jsx(se,{size:16}),e.jsx("span",{children:"Share"})]})]})]}),e.jsx(R,{children:A&&e.jsxs(o.div,{className:"absolute left-1/2 transform -translate-x-1/2 top-full mt-4 bg-amber-50 border border-amber-200 rounded-xl p-3 shadow-lg z-50 flex items-start gap-3 max-w-md",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},children:[e.jsx(J,{size:18,className:"text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 text-sm font-medium",children:i===0?"Add Items First":u&&!l?"Board Limit Reached":!L&&p?"Save Required":"Upgrade Required"}),e.jsx("p",{className:"text-amber-700 text-xs",children:i===0?"Add some items to your vision board before saving.":u&&!l?`You've reached the limit of ${S.visionBoards} saved boards for your ${x.tier} plan. Upgrade or delete some boards.`:!L&&p?"You need to save your board before sharing it.":"Upgrade to Pro or Studio to access this feature."}),e.jsx("a",{href:"/upgrade",className:"text-xs text-amber-800 font-medium mt-1 inline-block hover:underline",children:"View Upgrade Options"})]})]})})]})}),e.jsx(Ce,{isOpen:y,onClose:()=>B(!1),onSave:k,isLoading:n,initialName:h,error:Q,hasReachedLimit:u&&!l,maxBoards:S.visionBoards}),e.jsx(De,{isOpen:D,onClose:()=>V(!1),onLoad:g,onDelete:b,savedBoards:s,isLoading:a,onLoadSavedBoards:w}),e.jsx(Ve,{isOpen:z,onClose:()=>F(!1),boardName:h||"My Vision Board",boardItems:m,totalBudget:t,originalBoardId:l,isSaved:L,canShare:p})]})},Ie=({product:i,index:t,onDragStart:r,onDoubleClick:s})=>{var a;return e.jsxs(o.div,{draggable:!0,onDragStart:n=>r(n,i),onDoubleClick:()=>s(i),className:"group bg-white/60 rounded-xl p-3 border border-slate-200/60 cursor-grab active:cursor-grabbing hover:shadow-md transition-all duration-300 hover:scale-105 hover:border-violet-300",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.05},whileHover:{y:-2},whileTap:{scale:.95},children:[e.jsxs("div",{className:"aspect-square bg-slate-100 rounded-lg mb-2 overflow-hidden relative",children:[e.jsx("img",{src:i.image||"",alt:i.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",onError:n=>{const m=n.target;m.src=`https://via.placeholder.com/150x150/f1f5f9/64748b?text=${encodeURIComponent(i.title.slice(0,10))}`}}),e.jsx("div",{className:"absolute inset-0 bg-violet-500/20 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/90 rounded-full p-1",children:e.jsx(me,{size:12,className:"text-violet-600"})})})]}),e.jsx("h3",{className:"font-medium text-slate-900 text-xs line-clamp-2 mb-1",children:i.title}),e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:((a=i.project)==null?void 0:a.name)||"Unknown Project"}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{className:"font-semibold text-slate-900 text-xs",children:["$",i.price]})})]})},ue=({hasLikedProducts:i,type:t})=>t==="products"?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ce,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 text-sm",children:i===!1?"No liked products yet. Like products from the curation page to see them here.":"No products match your current filters."})]}):e.jsx(o.div,{className:"absolute inset-0 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-2xl shadow-sm border-2 border-dashed border-slate-300 flex items-center justify-center mx-auto mb-6",children:e.jsx(ye,{className:"w-8 h-8 text-slate-400"})}),e.jsx("p",{className:"text-slate-600 font-medium text-lg mb-2",children:"Create your vision board"}),e.jsx("p",{className:"text-slate-500 text-sm max-w-xs",children:i===!1?"Like products from the curation page, then drag them here or double-click to add to center":"Drag products from the sidebar or double-click them to add to the center of your board"})]})}),Le=({isLoading:i,likedProducts:t,filteredProducts:r,onDragStart:s,onDoubleClick:a})=>i?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsxs("div",{className:"flex items-center space-x-2 text-slate-600",children:[e.jsx(X,{className:"animate-spin",size:16}),e.jsx("span",{className:"text-sm",children:"Loading liked products..."})]})}):r.length===0?e.jsx(ue,{hasLikedProducts:t.length>0,type:"products"}):e.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:r.map((n,m)=>e.jsx(Ie,{product:n,index:m,onDragStart:s,onDoubleClick:a},n.id))}),Pe=({isVisible:i,isLoading:t,likedProducts:r,filteredProducts:s,filters:a,projectOptions:n,onSearchChange:m,onProjectChange:l,onDragStart:h,onDoubleClick:c})=>e.jsx(R,{children:i&&e.jsx(o.div,{className:"lg:col-span-1",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl border border-slate-200/60 rounded-3xl p-6 shadow-xl shadow-slate-900/5 hover:shadow-2xl hover:shadow-slate-900/10 transition-all duration-500",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ce,{className:"w-4 h-4 text-red-500"}),e.jsx("h2",{className:"font-semibold text-lg text-slate-900",children:"Liked Products"})]}),e.jsx("div",{className:"bg-blue-50/80 rounded-xl p-3 mb-4",children:e.jsxs("p",{className:"text-xs text-blue-700 leading-relaxed",children:[e.jsx("strong",{children:"Drag & Drop:"})," Drag items to the board",e.jsx("br",{}),e.jsx("strong",{children:"Double-Click:"})," Add to center of board"]})}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search products...",value:a.searchQuery,onChange:d=>m(d.target.value),className:"w-full pl-8 pr-3 py-2 border border-slate-300/60 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500/50 focus:border-violet-500 bg-white/60 backdrop-blur-sm transition-all duration-300 text-xs"}),e.jsx(we,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 text-slate-400",size:14})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("select",{value:a.selectedProject,onChange:d=>l(d.target.value),className:"w-full pl-8 pr-3 py-2 border border-slate-300/60 rounded-xl focus:outline-none focus:ring-2 focus:ring-violet-500/50 focus:border-violet-500 bg-white/60 backdrop-blur-sm transition-all duration-300 text-xs appearance-none",children:n.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))}),e.jsx(xe,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 text-slate-400",size:14})]}),e.jsx(Le,{isLoading:t,likedProducts:r,filteredProducts:s,onDragStart:h,onDoubleClick:c})]})})}),$e=({item:i,isSelected:t,onSelect:r,onMove:s,onRemove:a,onResize:n})=>{const[m,l]=v.useState(!1),[h,c]=v.useState(!1),[d,f]=v.useState({x:0,y:0}),[g,b]=v.useState({x:0,y:0,width:0,height:0}),w=y=>{y.target.closest(".resize-handle")||y.target.closest(".remove-button")||(y.preventDefault(),l(!0),f({x:y.clientX-i.x,y:y.clientY-i.y}),r())},j=y=>{y.preventDefault(),y.stopPropagation(),console.log("Resize handle clicked",y.clientX,y.clientY),c(!0),b({x:y.clientX,y:y.clientY,width:i.width,height:i.height}),r()},x=v.useCallback(y=>{if(y.preventDefault(),m){const B=Math.max(0,y.clientX-d.x),D=Math.max(0,y.clientY-d.y);s(i.boardId,B,D)}else if(h){console.log("Resizing",y.clientX,y.clientY);const B=y.clientX-g.x,D=y.clientY-g.y,V=Math.max(150,Math.min(400,g.width+B)),z=Math.max(150,Math.min(400,g.height+D));console.log("New dimensions:",V,z),n(i.boardId,V,z)}},[m,h,d,g,i.boardId,s,n]),S=v.useCallback(y=>{y.preventDefault(),console.log("Mouse up - isDragging:",m,"isResizing:",h),l(!1),c(!1)},[m,h]);return v.useEffect(()=>{if(m||h)return document.body.style.userSelect="none",document.body.style.pointerEvents="none",document.addEventListener("mousemove",x,{passive:!1}),document.addEventListener("mouseup",S,{passive:!1}),()=>{document.body.style.userSelect="",document.body.style.pointerEvents="",document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",S)}},[m,h,x,S]),e.jsxs(o.div,{className:`absolute cursor-move select-none ${t?"z-20":"z-10"}`,style:{left:i.x,top:i.y,width:i.width,height:i.height},onMouseDown:w,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3},whileHover:{scale:1.02},children:[t&&e.jsxs(e.Fragment,{children:[e.jsx(o.div,{className:"absolute -inset-2 border-2 border-violet-500 rounded-3xl pointer-events-none",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},children:e.jsx(o.div,{className:"resize-handle absolute -bottom-3 -right-3 w-6 h-6 bg-violet-500 hover:bg-violet-600 rounded-full cursor-se-resize transition-colors duration-200 border-2 border-white shadow-lg flex items-center justify-center",onMouseDown:j,whileHover:{scale:1.2},whileTap:{scale:.9},style:{pointerEvents:"all"},children:e.jsx("div",{className:"w-2 h-2 bg-white group-hover:bg-green-400 rounded-full opacity-100 transition-colors duration-200"})})}),e.jsx(o.div,{className:"absolute -top-12 left-0 bg-violet-500 text-white text-xs px-3 py-1.5 rounded-xl shadow-lg whitespace-nowrap max-w-xs pointer-events-none",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs("div",{className:"truncate",children:[i.title.slice(0,30),"... - $",i.price]})})]}),e.jsxs("div",{className:"relative w-full h-full bg-white/80 backdrop-blur-xl border border-slate-200/60 rounded-2xl shadow-lg hover:shadow-2xl hover:shadow-slate-900/5 transition-all duration-500 overflow-hidden group",children:[t&&e.jsx(o.button,{className:"remove-button absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-all duration-200 shadow-xl z-30 border-3 border-white hover:border-red-100",onClick:y=>{y.stopPropagation(),a()},initial:{scale:0},animate:{scale:1},whileHover:{scale:1.15,boxShadow:"0 8px 25px rgba(239, 68, 68, 0.4)"},whileTap:{scale:.9},transition:{type:"spring",stiffness:400,damping:17},style:{pointerEvents:"all"},children:e.jsx(ee,{size:16,strokeWidth:2.5})}),e.jsxs("div",{className:"relative w-full h-full overflow-hidden",children:[e.jsx("img",{src:i.image||"",alt:i.title,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",onError:y=>{const B=y.target;B.src=`https://via.placeholder.com/400x400/f1f5f9/64748b?text=${encodeURIComponent(i.title.slice(0,20))}`}}),e.jsx(o.div,{className:"absolute inset-0 bg-slate-900/70 opacity-0 group-hover:opacity-100 transition-all duration-300 flex items-end",initial:!1,children:e.jsxs("div",{className:"p-4 text-white w-full",children:[e.jsx("h3",{className:"font-semibold text-sm mb-1 line-clamp-2",children:i.title}),e.jsxs("p",{className:"text-slate-200 text-xs",children:["$",i.price]})]})})]})]})]})},Fe=({boardRef:i,boardItems:t,selectedItem:r,isDragOver:s,hasLikedProducts:a,onDrop:n,onDragOver:m,onDragEnter:l,onDragLeave:h,onItemSelect:c,onItemMove:d,onItemRemove:f,onItemResize:g})=>e.jsxs(o.div,{className:"bg-white/80 backdrop-blur-xl border border-slate-200/60 rounded-3xl shadow-xl shadow-slate-900/5 hover:shadow-2xl hover:shadow-slate-900/10 transition-all duration-500 overflow-hidden",layout:!0,transition:{duration:.3},children:[e.jsx("div",{className:"p-6 border-b border-slate-200/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"font-semibold text-2xl text-slate-900 flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-violet-500 rounded-full"}),"Your Vision Board"]}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:e.jsxs("span",{children:[t.length," items"]})})]})}),e.jsxs("div",{ref:i,onDrop:n,onDragOver:m,onDragEnter:l,onDragLeave:h,className:`relative bg-gradient-to-br from-slate-50/50 to-white/50 min-h-[600px] overflow-hidden transition-all duration-300 ${s?"bg-violet-50/50 border-2 border-dashed border-violet-400":""}`,style:{backgroundImage:`
            radial-gradient(circle at 1px 1px, rgba(148, 163, 184, 0.15) 1px, transparent 0)
          `,backgroundSize:"20px 20px"},children:[s&&e.jsx(o.div,{className:"absolute inset-0 flex items-center justify-center pointer-events-none",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},children:e.jsx("div",{className:"bg-violet-500/90 text-white px-6 py-3 rounded-2xl shadow-lg backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{size:20}),e.jsx("span",{className:"font-medium",children:"Drop to add to board"})]})})}),t.length===0&&!s&&e.jsx(ue,{hasLikedProducts:a,type:"board"}),e.jsx(R,{children:t.map(b=>e.jsx($e,{item:b,isSelected:r===b.boardId,onSelect:()=>c(b.boardId===r?null:b.boardId),onMove:d,onRemove:()=>f(b.boardId),onResize:g},b.boardId))})]})]}),Ke=()=>{const i=v.useRef(null),t=v.useRef(null),{likedProducts:r,projects:s,isLoading:a,refreshData:n}=Se(),{boardItems:m,selectedItem:l,showSidebar:h,totalBudget:c,savedBoards:d,isLoadingSavedBoards:f,isSaving:g,currentBoardId:b,currentBoardName:w,addItemToBoard:j,moveItem:x,resizeItem:S,removeItem:y,selectItem:B,clearBoard:D,toggleSidebar:V,saveBoard:z,updateBoardName:F,loadBoard:A,deleteBoard:N,loadSavedBoards:Q}=ke(),{isDragOver:U,handleDragStart:G,handleDrop:M,handleDragOver:q,handleDragEnter:T,handleDragLeave:p,handleDoubleClick:u}=Ee(j,t),{filters:k,filteredProducts:E,projectOptions:_,updateSearchQuery:$,updateSelectedProject:K}=Be(r,s),H=async C=>{try{await A(C),n()}catch(P){console.error("Error loading board:",P)}},Y=async C=>{try{await z(C),n()}catch(P){console.error("Error saving board:",P)}},O=async(C,P)=>{try{await F(C,P),n()}catch(he){console.error("Error updating board name:",he)}},L=C=>{var P;(P=i.current)==null||P.getBoundingClientRect()};return e.jsxs("div",{ref:i,className:"pt-16 relative overflow-hidden bg-gradient-to-b from-white via-slate-50/30 to-white min-h-screen",onMouseMove:L,children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx(o.div,{className:"absolute top-1/4 right-1/4 w-96 h-96 bg-gradient-to-br from-violet-100/40 to-blue-100/40 rounded-full blur-3xl",animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),e.jsx("div",{className:"absolute inset-0 opacity-[0.02]",children:e.jsxs("svg",{className:"w-full h-full",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"vision-dots",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:e.jsx("circle",{cx:"20",cy:"20",r:"1",fill:"currentColor"})})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#vision-dots)",className:"text-slate-600"})]})})]}),e.jsx(_e,{}),e.jsx(ze,{itemCount:m.length,totalBudget:c,showSidebar:h,savedBoards:d,isLoadingSavedBoards:f,isSaving:g,boardItems:m,currentBoardId:b,currentBoardName:w,onToggleSidebar:V,onClearBoard:D,onSaveBoard:Y,onLoadBoard:H,onDeleteBoard:N,onLoadSavedBoards:Q,onUpdateBoardName:O}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 lg:px-8 py-20 relative z-10",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[e.jsx(Pe,{isVisible:h,isLoading:a,likedProducts:r,filteredProducts:E,filters:k,projectOptions:_,onSearchChange:$,onProjectChange:K,onDragStart:G,onDoubleClick:u}),e.jsx("div",{className:`${h?"lg:col-span-2":"lg:col-span-3"}`,children:e.jsx(Fe,{boardRef:t,boardItems:m,selectedItem:l,isDragOver:U,hasLikedProducts:r.length>0,onDrop:M,onDragOver:q,onDragEnter:T,onDragLeave:p,onItemSelect:B,onItemMove:x,onItemRemove:y,onItemResize:S})})]})})]})};export{Ke as default};
